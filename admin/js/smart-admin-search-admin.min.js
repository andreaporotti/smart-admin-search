!function(e){"use strict";e.fn.sasSelect2=e.fn.select2,"undefined"!=typeof currentSelect2&&null!==currentSelect2&&(e.fn.select2=currentSelect2),e((function(){let s=e(document),t=e("body"),n=e(".sas-search-modal"),l=e(".sas-search-modal__close"),a=e(".sas-search-modal__select"),r=e("#wp-admin-bar-sas_icon");r.on("mousedown",(function(){d()})),r.on("click",(function(e){e.preventDefault()}));let c=sas_values.options.search_keys_shortcut.sort().map(Number),i=[];function o(s){if(s.loading)return s.text;let t="";void 0!==s.preview&&null!==s.preview&&""!==s.preview&&(t=`\n\t\t\t\t\t<div class="sas-search-result__preview">${s.preview}</div>\n\t\t\t\t`);let n="<hr>";1==sas_values.options.show_results_url&&(n=s.link_url),""!==s.link_url&&null!==s.link_url||(n=sas_values.strings.no_permissions);let l=`\n\t\t\t\t<div class="sas-search-result__link-url">${n}</div>\n\t\t\t`;return e(`\n\t\t\t\t<div class="sas-search-result">\n\t\t\t\t\t<div class="sas-search-result__icon wp-menu-image dashicons-before ${s.icon_class}" style="${s.style}"></div>\n\t\t\t\t\t<div class="sas-search-result__info">\n\t\t\t\t\t\t<div class="sas-search-result__name">${s.text}</div>\n\t\t\t\t\t\t<div class="sas-search-result__description">${s.description}</div>\n\t\t\t\t\t\t${l}\n\t\t\t\t\t</div>\n\t\t\t\t\t${t}\n\t\t\t\t</div>\n\t\t\t\t`)}function u(e){return""===e.id?sas_values.strings.search_select_placeholder:e.text}function d(){n.addClass("sas-search-modal--opened"),t.addClass("prevent-scroll"),a.sasSelect2({dropdownParent:n,width:"100%",placeholder:sas_values.strings.search_select_placeholder,minimumInputLength:3,allowClear:!0,templateResult:o,templateSelection:u,ajax:{method:"GET",url:sas_values.ajax.search_url,delay:400,beforeSend:function(e){e.setRequestHeader("X-WP-NONCE",sas_values.ajax.nonce)},data:function(e){return{query:e.term}},processResults:function(e){return{results:e}}}}),setTimeout((function(){a.sasSelect2("open")}),300)}function _(){a.hasClass("select2-hidden-accessible")&&(n.removeClass("sas-search-modal--opened"),t.removeClass("prevent-scroll"),a.sasSelect2("destroy"),a.empty())}s.on("keydown",(function(s){e(s.srcElement).hasClass("sas-skip-global-keypress")||(!1===i.includes(s.which)&&i.push(s.which),JSON.stringify(i.sort())===JSON.stringify(c)?d():i.includes(27)&&_())})),s.on("keyup",(function(s){e(s.srcElement).hasClass("sas-skip-global-keypress")||(i=[])})),n.on("click",(function(e){e.target===this&&_()})),l.on("click",(function(e){e.target===this&&_()})),a.on("select2:select",(function(e){let s=e.params.data;null!==s.link_url&&""!==s.link_url&&(window.location.href=s.link_url)})),a.on("select2:open",(function(){document.querySelector(".sas-search-modal--opened .select2-search__field").focus()}))}))}(jQuery);